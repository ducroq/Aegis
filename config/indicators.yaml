# Aegis Indicator Configuration
# Defines which economic indicators to track and how to score them

recession_indicators:
  description: "Leading indicators of economic recession (ENHANCED: Rate of change emphasis)"

  # ENHANCEMENT: Unemployment Claims VELOCITY (more leading than unemployment rate)
  unemployment_claims_velocity:
    source: "FRED"
    series_id: "ICSA"
    name: "Initial Unemployment Claims - 4-Week Average YoY Change"
    update_frequency: "weekly"
    calculation: "4wk_moving_avg_yoy_pct_change"
    scoring:
      # Velocity scoring (leading indicator)
      extreme_spike: 0.15  # 15% YoY increase = score +4.0
      moderate_spike: 0.08  # 8% YoY increase = score +2.0
      rising: 0.03  # 3% YoY increase = score +1.0
      stable: 0.0
    weight: 0.40  # Heavy weight due to leading nature

  # ENHANCEMENT: PMI REGIME CROSS detection (expansion â†’ contraction)
  ism_pmi_regime:
    source: "FRED"
    series_id: "NAPM"
    name: "ISM Manufacturing PMI (Diffusion Index)"
    update_frequency: "monthly"
    scoring:
      # Critical signal: cross from expansion to contraction
      cross_into_contraction: 50  # Triggers +3.0 if previous >= 50 and current < 50
      deep_contraction: 45  # Below 45 = score +2.5
      shallow_contraction: 50  # Below 50 = score +1.5
      slowing_expansion: 52  # Below 52 (warning) = score +1.0
      healthy_expansion: 52  # Above 52 = score 0
    weight: 0.30  # High weight for regime shift

  # ENHANCEMENT: Dual yield curve monitoring
  yield_curve_traditional:
    source: "FRED"
    series_id: "T10Y2Y"
    name: "10-Year minus 2-Year Treasury Spread"
    update_frequency: "daily"
    scoring:
      deep_inversion: -0.50  # Score +3.0
      shallow_inversion: 0.00  # Score +1.5
      normal: 0.50
    weight: 0.15

  # ENHANCEMENT: Near-term forward spread (NY Fed research)
  yield_curve_forward:
    source: "CALCULATED"
    calculation: "fed_funds_futures_18m - tbill_3m"
    name: "3-Month to 18-Month Forward Spread"
    update_frequency: "daily"
    data_sources:
      futures: "CME_FED_FUNDS_FUTURES"
      tbill: "FRED:DTB3"
    scoring:
      deep_inversion: -0.30  # Score +2.0
      shallow_inversion: 0.00  # Score +1.0
      normal: 0.30
    weight: 0.15
    note: "Often inverts BEFORE traditional 10Y-2Y, providing earlier warning"

  # Bonus for both curves inverted
  dual_inversion_bonus:
    condition: "both_curves_inverted"
    score_adjustment: 1.0

  consumer_confidence:
    source: "FRED"
    series_id: "UMCSENT"  # University of Michigan Consumer Sentiment
    name: "Consumer Confidence Index"
    update_frequency: "monthly"
    scoring:
      low: 90
      normal: 100

credit_indicators:
  description: "Credit market stress and risk appetite (ENHANCED: Velocity emphasis)"

  # ENHANCEMENT: High-yield spread VELOCITY (rate of change > level)
  high_yield_velocity:
    source: "FRED"
    series_id: "BAMLH0A0HYM2"
    name: "ICE BofA US High Yield OAS - Rate of Change"
    update_frequency: "daily"
    calculations:
      velocity: "20day_rate_of_change"  # Daily bps change over 20 trading days
      level: "current_value"
    scoring:
      # Velocity scoring (immediate liquidity/funding crisis signal)
      rapid_widening: 0.1  # 10 bps/day widening = score +4.0
      moderate_widening: 0.05  # 5 bps/day = score +2.0
      stable: 0.02
      # Level scoring (absolute threshold)
      extreme_level: 8.0  # Score +3.0
      high_level: 6.0  # Score +2.0
      elevated_level: 4.0  # Score +1.0
      normal_level: 3.0
    weighting:
      velocity: 0.7  # Weight velocity MORE than level
      level: 0.3
    note: "Spreads widening rapidly = immediate stress, even if levels not extreme yet"

  investment_grade_spreads:
    source: "FRED"
    series_id: "BAMLC0A4CBBB"
    name: "ICE BofA BBB US Corporate Bond Spread"
    update_frequency: "daily"
    scoring:
      extreme: 4.0
      elevated: 2.5
      normal: 1.5

  bank_lending_standards:
    source: "FRED"
    series_id: "DRTSCILM"  # Senior Loan Officer Survey
    name: "Net Percentage of Banks Tightening Standards"
    update_frequency: "quarterly"
    scoring:
      # Positive = tightening (bad), Negative = easing (good)
      severe_tightening: 30
      moderate_tightening: 15

  ted_spread:
    source: "FRED"
    series_id: "TEDRATE"
    name: "TED Spread (3-Month LIBOR - 3-Month T-Bill)"
    update_frequency: "daily"
    scoring:
      crisis: 2.0  # 2008 crisis levels
      stress: 1.0
      normal: 0.5

valuation_indicators:
  description: "Market valuation extremes"

  shiller_cape:
    source: "SHILLER"
    url: "http://www.econ.yale.edu/~shiller/data/ie_data.xls"
    name: "Shiller Cyclically Adjusted PE Ratio"
    update_frequency: "monthly"
    scoring:
      # Historical average ~16-17
      extreme_bubble: 35  # Dot-com levels
      elevated: 30
      high: 25
      normal: 20
      attractive: 15

  buffett_indicator:
    source: "CALCULATED"
    numerator: "FRED:WILSHIRE5000IND"  # Total market cap proxy
    denominator: "FRED:GDP"
    name: "Market Cap to GDP Ratio (Buffett Indicator)"
    update_frequency: "quarterly"
    scoring:
      # Buffett: >100% is overvalued
      extreme: 200
      very_high: 150
      elevated: 120
      fair: 100
      attractive: 80

  forward_pe:
    source: "YAHOO"
    ticker: "^GSPC"  # S&P 500
    name: "S&P 500 Forward P/E Ratio"
    update_frequency: "daily"
    scoring:
      extreme: 25
      elevated: 22
      historical_avg: 18
      attractive: 15

liquidity_indicators:
  description: "Monetary policy and liquidity conditions"

  fed_funds_rate:
    source: "FRED"
    series_id: "DFF"
    name: "Federal Funds Effective Rate"
    update_frequency: "daily"
    scoring:
      # High rates = tight policy (risk), low rates = loose (supportive)
      # Score based on rate of change, not absolute level
      rapid_tightening: 2.0  # Percentage point increase in 6 months
      tightening: 1.0

  m2_money_supply:
    source: "FRED"
    series_id: "M2SL"
    name: "M2 Money Supply"
    update_frequency: "weekly"
    scoring:
      # Year-over-year growth rate
      contraction: 0  # Negative growth = high risk
      low_growth: 2  # <2% YoY
      normal: 6  # 4-8% YoY

  margin_debt:
    source: "FINRA"
    series_id: "MARGIN_DEBT"
    name: "NYSE Margin Debt"
    update_frequency: "monthly"
    scoring:
      # As percentage of market cap or YoY change
      extreme_speculation: 3.0  # Percent of GDP
      elevated: 2.5

  fed_balance_sheet:
    source: "FRED"
    series_id: "WALCL"
    name: "Federal Reserve Total Assets"
    update_frequency: "weekly"
    scoring:
      # QT (quantitative tightening) = risk
      rapid_qt: -500  # Billion USD per quarter
      qt: -200

geopolitical_indicators:
  description: "Geopolitical risks and shocks"

  policy_uncertainty:
    source: "FRED"
    series_id: "USEPUINDXD"
    name: "Economic Policy Uncertainty Index"
    update_frequency: "daily"
    scoring:
      extreme: 300
      elevated: 200
      normal: 100

  oil_price_shock:
    source: "FRED"
    series_id: "DCOILWTICO"
    name: "WTI Crude Oil Price"
    update_frequency: "daily"
    scoring:
      # Rapid price increases = supply shock
      extreme_spike: 50  # Percent increase in 3 months
      spike: 30

  vix:
    source: "YAHOO"
    ticker: "^VIX"
    name: "CBOE Volatility Index"
    update_frequency: "daily"
    scoring:
      # VIX as fear gauge
      panic: 40
      fear: 30
      elevated: 20
      complacent: 12

# ENHANCEMENT: Positioning & Speculation Indicators
positioning_indicators:
  description: "CFTC Commitments of Traders - Extreme positioning signals"

  sp500_speculative_positioning:
    source: "CFTC"
    report: "Commitments of Traders"
    contract: "S&P 500 (CME)"
    name: "S&P 500 Net Speculative Position"
    update_frequency: "weekly"
    calculation: "net_speculative_percentile_2y"  # (Long - Short) / Open Interest, percentile vs 2-year history
    scoring:
      # Extreme positioning = contrarian signal
      extreme_long: 95  # 95th percentile = complacency, score +2.0 (risk of reversal)
      elevated_long: 85  # 85th percentile = score +1.0
      neutral: 50
      extreme_short: 5  # 5th percentile = capitulation, score -1.0 (contrarian opportunity)
    note: "Extreme net long = crowded trade, reversal risk. Extreme short = potential bottom."

  treasury_speculative_positioning:
    source: "CFTC"
    report: "Commitments of Traders"
    contract: "10-Year Treasury Note (CBOT)"
    name: "Treasury Net Speculative Position"
    update_frequency: "weekly"
    calculation: "net_speculative_percentile_2y"
    scoring:
      extreme_short: 5  # Crowded short = squeeze/funding risk, score +1.5
      elevated_short: 15  # Score +0.5
      neutral: 50
    note: "Extreme shorts in Treasuries = potential short squeeze risk during flight-to-quality"

  vix_futures_positioning:
    source: "CFTC"
    contract: "VIX Futures"
    name: "VIX Futures Net Non-Commercial Position"
    update_frequency: "weekly"
    calculation: "net_noncommercial_position"
    scoring:
      extreme_short_vix: -10000  # Contracts, complacency signal
      moderate_short_vix: -5000
    note: "Net short VIX futures = complacency, potential for volatility spike"

# Data sources configuration
data_sources:
  fred:
    base_url: "https://api.stlouisfed.org/fred/series/observations"
    rate_limit: null  # No official limit, be reasonable

  yahoo:
    library: "yfinance"
    rate_limit: null

  shiller:
    url: "http://www.econ.yale.edu/~shiller/data/ie_data.xls"
    update_day: 1  # First of month
    cache_days: 30
